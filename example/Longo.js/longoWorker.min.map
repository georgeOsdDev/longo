{"version":3,"file":"longoWorker.min.js","sources":["../src/longoWorker.js"],"names":["applyOperator","doc","current","pairs","result","_","identity","operators","keys","each","op","k","isNumber","has","objectId","val","Date","now","shuffle","CHARS","join","substr","toQuery","criteria","Utils","checkOrElse","isObject","isArray","isFunction","toDocument","arr","toArray","object","doStart","command","seq","self","name","option","dataset","isUpdatedBySeq","logger","doFind","query","doInsert","docs","isZero","size","SKIP_REST","omit","first","UPDATE_OPERATORS","_id","where","length","Longo","Error","DUPLICATE_KEY_ERROR","push","rest","updateById","MOD_ID_NOT_ALLOWED","pick","normal","INVALID_MODIFIER_SPECIFIED","reject","d","concat","doUpdate","update","hits","upsert","DOCUMENT_NOT_FOUND","JSON","stringify","isOne","multi","res","every","doSave","doRemove","justOne","ids","pluck","contains","doProject","projection","includes","filter","p","isTrue","excludes","isFalse","without","union","map","doLimit","limit","doSkip","skip","doCount","doSize","str2ab","bytesize","doToArray","doMax","indexBounds","v","values","$lte","doMin","$gte","doForEach","func","f","Function","forEach","e","EVAL_ERROR","stack","doMap","doSort","sorter","isString","sorted","key","order","sortBy","reverse","getExecuter","memo","error","cmd","getOrElse","value","obj","method","msg","workerName","loglevel","_console","console","undefined","call","importScripts","capped","split","send","message","seqs","json","bytes","postMessage","buffer","addEventListener","request","data","cmds","executer","tryParseJSON","ab2str","reduce","isUpdated"],"mappings":"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"}